"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},46667:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p});var o={};t.r(o),t.d(o,{POST:()=>l});var r=t(49303),n=t(88716),a=t(60670),i=t(87070),c=t(2021),u=t(71732);async function l(e){try{console.log("\uD83D\uDCDD Registration API called");let{name:s,email:t,password:o}=await e.json();if(console.log("\uD83D\uDCDD Registration attempt:",{name:s,email:t}),!s||!t||!o)return i.NextResponse.json({success:!1,message:"Nome, email e senha s\xe3o obrigat\xf3rios"},{status:400});if(o.length<6)return i.NextResponse.json({success:!1,message:"Senha deve ter pelo menos 6 caracteres"},{status:400});try{let e=(0,c.u)(),s=new Promise((e,s)=>setTimeout(()=>s(Error("MongoDB connection timeout")),8e3));await Promise.race([e,s]),console.log("✅ MongoDB connected")}catch(e){return console.error("❌ MongoDB connection failed:",e),i.NextResponse.json({success:!1,message:"Erro de conex\xe3o com o banco de dados. Tente novamente em alguns minutos."},{status:503})}if(await u.Z.findOne({email:t}))return i.NextResponse.json({success:!1,message:"Este email j\xe1 est\xe1 cadastrado"},{status:409});let r=new u.Z({name:s,email:t,password:o});await r.save(),console.log("✅ User registered successfully:",r.email);let n={id:r._id,name:r.name,email:r.email,isActive:r.isActive,createdAt:r.createdAt};return i.NextResponse.json({success:!0,message:"Usu\xe1rio cadastrado com sucesso",user:n},{status:201})}catch(e){if(console.error("❌ Registration error:",e),11e3===e.code)return i.NextResponse.json({success:!1,message:"Este email j\xe1 est\xe1 cadastrado"},{status:409});return i.NextResponse.json({success:!1,message:"Erro interno do servidor"},{status:500})}}let m=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\Users\\aluno\\OneDrive\\Desktop\\clipeiro\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:g}=m,h="/api/auth/register/route";function v(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},2021:(e,s,t)=>{t.d(s,{u:()=>c});var o=t(11185),r=t.n(o);let n=process.env.MONGODB_URI||"mongodb+srv://clipeiroai:otaviosnow2012@cluster0.0afjdgs.mongodb.net/clipeiro?retryWrites=true&w=majority&appName=Cluster0";process.env.MONGODB_URI||console.warn("⚠️ MONGODB_URI n\xe3o definida nas vari\xe1veis de ambiente");let a={bufferCommands:!1,maxPoolSize:10,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3,family:4,retryWrites:!0,w:"majority"},i=global.mongoose;async function c(){if(i.conn)return i.conn;i.promise||(i.promise=r().connect(n,a).then(e=>(console.log("✅ MongoDB connected successfully"),e)).catch(e=>{throw console.error("❌ MongoDB connection failed:",e.message),e}));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}i||(i=global.mongoose={conn:null,promise:null})},71732:(e,s,t)=>{t.d(s,{Z:()=>c});var o=t(11185),r=t.n(o),n=t(42023),a=t.n(n);let i=new o.Schema({name:{type:String,required:[!0,"Nome \xe9 obrigat\xf3rio"],trim:!0,minlength:[2,"Nome deve ter pelo menos 2 caracteres"],maxlength:[100,"Nome deve ter no m\xe1ximo 100 caracteres"]},email:{type:String,required:[!0,"Email \xe9 obrigat\xf3rio"],unique:!0,lowercase:!0,trim:!0,match:[/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/,"Email inv\xe1lido"]},password:{type:String,required:[!0,"Senha \xe9 obrigat\xf3ria"],minlength:[6,"Senha deve ter pelo menos 6 caracteres"],select:!1},isActive:{type:Boolean,default:!0}},{timestamps:!0});i.pre("save",async function(e){if(!this.isModified("password"))return e();try{let s=await a().genSalt(12);this.password=await a().hash(this.password,s),e()}catch(s){e(s)}}),i.methods.comparePassword=async function(e){return a().compare(e,this.password)};let c=r().models.User||r().model("User",i)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),o=s.X(0,[276,972,23],()=>t(46667));module.exports=o})();